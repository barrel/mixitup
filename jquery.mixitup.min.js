/*
* MIXITUP - A CSS3 and JQuery Filter & Sort Plugin
* Version: 1.5.3
* License: Creative Commons Attribution-NoDerivs 3.0 Unported - CC BY-ND 3.0
* http://creativecommons.org/licenses/by-nd/3.0/
* This software may be used freely on commercial and non-commercial projects with attribution to the author/copyright holder.
* Author: Patrick Kunka
* Copyright 2012-2013 Patrick Kunka, Barrel LLC, All Rights Reserved
* 
* http://mixitup.io
*/

(function(e){function n(t,n,i,o,u){function C(){d.unbind();if(n){r(n,i,o,u)}u.startOrder=[],u.newOrder=[],u.origSort=[],u.checkSort=[];p.removeStyle(u.prefix+"filter, filter, "+u.prefix+"transform, transform, opacity, display").css(u.clean).removeAttr("data-checksum");if(!window.atob){p.css({display:"none",opacity:"0"})}var e=u.resizeContainer?"height":"";d.removeStyle(u.prefix+"transition, transition, "+u.prefix+"perspective, perspective, "+u.prefix+"perspective-origin, perspective-origin, "+e);if(u.layoutMode=="list"){m.css({display:u.targetDisplayList,opacity:"1"});u.origDisplay=u.targetDisplayList}else{m.css({display:u.targetDisplayGrid,opacity:"1"});u.origDisplay=u.targetDisplayGrid}u.origLayout=u.layoutMode;var t=setTimeout(function(){p.removeStyle(u.prefix+"transition, transition");u.mixing=false;if(typeof u.onMixEnd=="function"){var e=u.onMixEnd.call(this,u);u=e?e:u}})}clearInterval(u.failsafe);u.mixing=true;u.filter=t;if(typeof u.onMixStart=="function"){var a=u.onMixStart.call(this,u);u=a?a:u}var f=u.transitionSpeed;for(var l=0;l<2;l++){var c=l==0?c=u.prefix:"";u.transition[c+"transition"]="all "+f+"ms linear";u.transition[c+"transform"]=c+"translate3d(0,0,0)";u.perspective[c+"perspective"]=u.perspectiveDistance+"px";u.perspective[c+"perspective-origin"]=u.perspectiveOrigin}var h=u.targetSelector,p=o.find(h);p.each(function(){this.data={}});var d=p.parent();d.css(u.perspective);u.easingFallback="ease-in-out";if(u.easing=="smooth")u.easing="cubic-bezier(0.25, 0.46, 0.45, 0.94)";if(u.easing=="snap")u.easing="cubic-bezier(0.77, 0, 0.175, 1)";if(u.easing=="windback"){u.easing="cubic-bezier(0.175, 0.885, 0.320, 1.275)",u.easingFallback="cubic-bezier(0.175, 0.885, 0.320, 1)"}if(u.easing=="windup"){u.easing="cubic-bezier(0.6, -0.28, 0.735, 0.045)",u.easingFallback="cubic-bezier(0.6, 0.28, 0.735, 0.045)"}var v=u.layoutMode=="list"&&u.listEffects!=null?u.listEffects:u.effects;if(Array.prototype.indexOf){u.fade=v.indexOf("fade")>-1?"0":"";u.scale=v.indexOf("scale")>-1?"scale(.01)":"";u.rotateZ=v.indexOf("rotateZ")>-1?"rotate(180deg)":"";u.rotateY=v.indexOf("rotateY")>-1?"rotateY(90deg)":"";u.rotateX=v.indexOf("rotateX")>-1?"rotateX(90deg)":"";u.blur=v.indexOf("blur")>-1?"blur(8px)":"";u.grayscale=v.indexOf("grayscale")>-1?"grayscale(100%)":""}var m=e(),g=e(),y=[],b=false;if(typeof t==="string"){y=s(t)}else{b=true;e.each(t,function(e){y[e]=s(this)})}if(u.filterLogic=="or"){if(y[0]=="")y.shift();if(y.length<1){g=g.add(o.find(h+":visible"))}else{p.each(function(){var t=e(this);if(!b){if(t.is("."+y.join(", ."))){m=m.add(t)}else{g=g.add(t)}}else{var n=0;e.each(y,function(e){if(this.length){if(t.is("."+this.join(", ."))){n++}}else if(n>0){n++}});if(n==y.length){m=m.add(t)}else{g=g.add(t)}}})}}else{m=m.add(d.find(h+"."+y.join(".")));g=g.add(d.find(h+":not(."+y.join(".")+"):visible"))}var w=m.length;var E=e(),S=e(),x=e();g.each(function(){var t=e(this);if(t.css("display")!="none"){E=E.add(t);x=x.add(t)}});if(m.filter(":visible").length==w&&!E.length&&!n){if(u.origLayout==u.layoutMode){C();return false}else{if(m.length==1){if(u.layoutMode=="list"){o.addClass(u.listClass);o.removeClass(u.gridClass);x.css("display",u.targetDisplayList)}else{o.addClass(u.gridClass);o.removeClass(u.listClass);x.css("display",u.targetDisplayGrid)}C();return false}}}u.origHeight=d.height();if(m.length){o.removeClass(u.failClass);m.each(function(){var t=e(this);if(t.css("display")=="none"){S=S.add(t)}else{x=x.add(t)}});if(u.origLayout!=u.layoutMode&&u.animateGridList==false){if(u.layoutMode=="list"){o.addClass(u.listClass);o.removeClass(u.gridClass);x.css("display",u.targetDisplayList)}else{o.addClass(u.gridClass);o.removeClass(u.listClass);x.css("display",u.targetDisplayGrid)}C();return false}if(!window.atob){C();return false}p.css(u.clean);x.each(function(){this.data.origPos=e(this).offset()});if(u.layoutMode=="list"){o.addClass(u.listClass);o.removeClass(u.gridClass);S.css("display",u.targetDisplayList)}else{o.addClass(u.gridClass);o.removeClass(u.listClass);S.css("display",u.targetDisplayGrid)}S.each(function(){this.data.showInterPos=e(this).offset()});E.each(function(){this.data.hideInterPos=e(this).offset()});x.each(function(){this.data.preInterPos=e(this).offset()});if(u.layoutMode=="list"){x.css("display",u.targetDisplayList)}else{x.css("display",u.targetDisplayGrid)}if(n){r(n,i,o,u)}if(n&&u.origSort.compare(u.checkSort)){C();return false}E.hide();S.each(function(t){this.data.finalPos=e(this).offset()});x.each(function(){this.data.finalPrePos=e(this).offset()});u.newHeight=d.height();if(n){r("reset",null,o,u)}S.hide();x.css("display",u.origDisplay);if(u.origDisplay=="block"){o.addClass(u.listClass);S.css("display",u.targetDisplayList)}else{o.removeClass(u.listClass);S.css("display",u.targetDisplayGrid)}if(u.resizeContainer)d.css("height",u.origHeight+"px");var T={};for(var l=0;l<2;l++){var c=l==0?c=u.prefix:"";T[c+"transform"]=u.scale+" "+u.rotateX+" "+u.rotateY+" "+u.rotateZ;T[c+"filter"]=u.blur+" "+u.grayscale}S.css(T);x.each(function(){var t=this.data,n=e(this);if(n.hasClass("mix_tohide")){t.preTX=t.origPos.left-t.hideInterPos.left;t.preTY=t.origPos.top-t.hideInterPos.top}else{t.preTX=t.origPos.left-t.preInterPos.left;t.preTY=t.origPos.top-t.preInterPos.top}var r={};for(var i=0;i<2;i++){var s=i==0?s=u.prefix:"";r[s+"transform"]="translate("+t.preTX+"px,"+t.preTY+"px)"}n.css(r)});if(u.layoutMode=="list"){o.addClass(u.listClass);o.removeClass(u.gridClass)}else{o.addClass(u.gridClass);o.removeClass(u.listClass)}var N=setTimeout(function(){if(u.resizeContainer){var t={};for(var n=0;n<2;n++){var r=n==0?r=u.prefix:"";t[r+"transition"]="all "+f+"ms ease-in-out";t["height"]=u.newHeight+"px"}d.css(t)}E.css("opacity",u.fade);S.css("opacity",1);S.each(function(){var t=this.data;t.tX=t.finalPos.left-t.showInterPos.left;t.tY=t.finalPos.top-t.showInterPos.top;var n={};for(var r=0;r<2;r++){var i=r==0?i=u.prefix:"";n[i+"transition-property"]=i+"transform, "+i+"filter, opacity";n[i+"transition-timing-function"]=u.easing+", linear, linear";n[i+"transition-duration"]=f+"ms";n[i+"transition-delay"]="0";n[i+"transform"]="translate("+t.tX+"px,"+t.tY+"px)";n[i+"filter"]="none"}e(this).css("-webkit-transition","all "+f+"ms "+u.easingFallback).css(n)});x.each(function(){var t=this.data;t.tX=t.finalPrePos.left!=0?t.finalPrePos.left-t.preInterPos.left:0;t.tY=t.finalPrePos.left!=0?t.finalPrePos.top-t.preInterPos.top:0;var n={};for(var r=0;r<2;r++){var i=r==0?i=u.prefix:"";n[i+"transition"]="all "+f+"ms "+u.easing;n[i+"transform"]="translate("+t.tX+"px,"+t.tY+"px)"}e(this).css("-webkit-transition","all "+f+"ms "+u.easingFallback).css(n)});var i={};for(var n=0;n<2;n++){var r=n==0?r=u.prefix:"";i[r+"transition"]="all "+f+"ms "+u.easing+", "+r+"filter "+f+"ms linear, opacity "+f+"ms linear";i[r+"transform"]=u.scale+" "+u.rotateX+" "+u.rotateY+" "+u.rotateZ;i[r+"filter"]=u.blur+" "+u.grayscale;i["opacity"]=u.fade}E.css(i);d.bind("webkitTransitionEnd transitionend otransitionend oTransitionEnd",function(t){if(t.originalEvent.propertyName.indexOf("transform")>-1||t.originalEvent.propertyName.indexOf("opacity")>-1){if(h.indexOf(".")>-1){if(e(t.target).hasClass(h.replace(".",""))){C()}}else{if(e(t.target).is(h)){C()}}}})},10);u.failsafe=setTimeout(function(){if(u.mixing){C()}},f+400)}else{if(u.resizeContainer)d.css("height",u.origHeight+"px");if(!window.atob){C();return false}E=g;var N=setTimeout(function(){d.css(u.perspective);if(u.resizeContainer){var e={};for(var t=0;t<2;t++){var n=t==0?n=u.prefix:"";e[n+"transition"]="height "+f+"ms ease-in-out";e["height"]=u.minHeight+"px"}d.css(e)}p.css(u.transition);var r=g.length;if(r){var i={};for(var t=0;t<2;t++){var n=t==0?n=u.prefix:"";i[n+"transform"]=u.scale+" "+u.rotateX+" "+u.rotateY+" "+u.rotateZ;i[n+"filter"]=u.blur+" "+u.grayscale;i["opacity"]=u.fade}E.css(i);d.bind("webkitTransitionEnd transitionend otransitionend oTransitionEnd",function(e){if(e.originalEvent.propertyName.indexOf("transform")>-1||e.originalEvent.propertyName.indexOf("opacity")>-1){o.addClass(u.failClass);C()}})}else{u.mixing=false}},10)}}function r(t,n,r,i){function s(e,n){var r=isNaN(e.attr(t)*1)?e.attr(t).toLowerCase():e.attr(t)*1,i=isNaN(n.attr(t)*1)?n.attr(t).toLowerCase():n.attr(t)*1;if(r<i)return-1;if(r>i)return 1;return 0}function o(e){if(n=="asc"){a.prepend(e).prepend(" ")}else{a.append(e).append(" ")}}function u(e){var t=e.slice();var n=t.length;var r=n;while(r--){var i=parseInt(Math.random()*n);var s=t[r];t[r]=t[i];t[i]=s}return t}r.find(i.targetSelector).wrapAll('<div class="mix_sorter"/>');var a=r.find(".mix_sorter");if(!i.origSort.length){a.find(i.targetSelector+":visible").each(function(){e(this).wrap("<s/>");i.origSort.push(e(this).parent().html().replace(/\s+/g,""));e(this).unwrap()})}a.empty();if(t=="reset"){e.each(i.startOrder,function(){a.append(this).append(" ")})}else if(t=="default"){e.each(i.origOrder,function(){o(this)})}else if(t=="random"){if(!i.newOrder.length){i.newOrder=u(i.startOrder)}e.each(i.newOrder,function(){a.append(this).append(" ")})}else if(t=="custom"){e.each(n,function(){o(this)})}else{if(typeof i.origOrder[0].attr(t)==="undefined"){console.log("No such attribute found. Terminating");return false}if(!i.newOrder.length){e.each(i.origOrder,function(){i.newOrder.push(e(this))});i.newOrder.sort(s)}e.each(i.newOrder,function(){o(this)})}i.checkSort=[];a.find(i.targetSelector+":visible").each(function(t){var n=e(this);if(t==0){n.attr("data-checksum","1")}n.wrap("<s/>");i.checkSort.push(n.parent().html().replace(/\s+/g,""));n.unwrap()});r.find(i.targetSelector).unwrap()}function i(e){var t=["Webkit","Moz","O","ms"];for(var n=0;n<t.length;n++){if(t[n]+"Transition"in e.style){return t[n]}}return"transition"in e.style?"":false}function s(t){t=t.replace(/\s{2,}/g," ");var n=t.split(" ");e.each(n,function(e){if(this=="all")n[e]="mix_all"});if(n[0]=="")n.shift();return n}var t={init:function(t){return this.each(function(){var s={targetSelector:".mix",filterSelector:".filter",sortSelector:".sort",buttonEvent:"click",effects:["fade","scale"],listEffects:null,easing:"smooth",layoutMode:"grid",targetDisplayGrid:"inline-block",targetDisplayList:"block",listClass:"",gridClass:"",transitionSpeed:600,showOnLoad:"all",sortOnLoad:false,multiFilter:false,filterLogic:"or",resizeContainer:true,minHeight:0,failClass:"fail",perspectiveDistance:"3000",perspectiveOrigin:"50% 50%",animateGridList:true,onMixLoad:null,onMixStart:null,onMixEnd:null,container:null,origOrder:[],startOrder:[],newOrder:[],origSort:[],checkSort:[],filter:"",mixing:false,origDisplay:"",origLayout:"",origHeight:0,newHeight:0,isTouch:false,resetDelay:0,failsafe:null,prefix:"",easingFallback:"ease-in-out",transition:{},perspective:{},clean:{},fade:"1",scale:"",rotateX:"",rotateY:"",rotateZ:"",blur:"",grayscale:""};if(t){e.extend(s,t)}this.config=s;e.support.touch="ontouchend"in document;if(e.support.touch){s.isTouch=true;s.resetDelay=350}s.container=e(this);var o=s.container;s.prefix=i(o[0]);s.prefix=s.prefix?"-"+s.prefix.toLowerCase()+"-":"";o.find(s.targetSelector).each(function(){s.origOrder.push(e(this))});if(s.sortOnLoad){var u,a;if(e.isArray(s.sortOnLoad)){u=s.sortOnLoad[0],a=s.sortOnLoad[1];e(s.sortSelector+"[data-sort="+s.sortOnLoad[0]+"][data-order="+s.sortOnLoad[1]+"]").addClass("active")}else{e(s.sortSelector+"[data-sort="+s.sortOnLoad+"]").addClass("active");u=s.sortOnLoad,s.sortOnLoad="desc"}r(u,a,o,s)}for(var f=0;f<2;f++){var l=f==0?l=s.prefix:"";s.transition[l+"transition"]="all "+s.transitionSpeed+"ms ease-in-out";s.perspective[l+"perspective"]=s.perspectiveDistance+"px";s.perspective[l+"perspective-origin"]=s.perspectiveOrigin}for(var f=0;f<2;f++){var l=f==0?l=s.prefix:"";s.clean[l+"transition"]="none"}if(s.layoutMode=="list"){o.addClass(s.listClass);s.origDisplay=s.targetDisplayList}else{o.addClass(s.gridClass);s.origDisplay=s.targetDisplayGrid}s.origLayout=s.layoutMode;var c=s.showOnLoad.split(" ");e.each(c,function(){e(s.filterSelector+'[data-filter="'+this+'"]').addClass("active")});o.find(s.targetSelector).addClass("mix_all");if(c[0]=="all"){c[0]="mix_all",s.showOnLoad="mix_all"}var h=e();e.each(c,function(){h=h.add(e("."+this))});h.each(function(){var t=e(this);if(s.layoutMode=="list"){t.css("display",s.targetDisplayList)}else{t.css("display",s.targetDisplayGrid)}t.css(s.transition)});var p=setTimeout(function(){s.mixing=true;h.css("opacity","1");var e=setTimeout(function(){if(s.layoutMode=="list"){h.removeStyle(s.prefix+"transition, transition").css({display:s.targetDisplayList,opacity:1})}else{h.removeStyle(s.prefix+"transition, transition").css({display:s.targetDisplayGrid,opacity:1})}s.mixing=false;if(typeof s.onMixLoad=="function"){var e=s.onMixLoad.call(this,s);s=e?e:s}},s.transitionSpeed)},10);s.filter=s.showOnLoad;e(s.sortSelector).bind(s.buttonEvent,function(){if(!s.mixing){var t=e(this),r=t.attr("data-sort"),i=t.attr("data-order");if(!t.hasClass("active")){e(s.sortSelector).removeClass("active");t.addClass("active")}else{if(r!="random")return false}o.find(s.targetSelector).each(function(){s.startOrder.push(e(this))});n(s.filter,r,i,o,s)}});e(s.filterSelector).bind(s.buttonEvent,function(){if(!s.mixing){var t=e(this);if(s.multiFilter==false){e(s.filterSelector).removeClass("active");t.addClass("active");s.filter=t.attr("data-filter");e(s.filterSelector+'[data-filter="'+s.filter+'"]').addClass("active")}else{var r=t.attr("data-filter");if(t.hasClass("active")){t.removeClass("active");var i=new RegExp("(\\s|^)"+r);s.filter=s.filter.replace(i,"")}else{t.addClass("active");s.filter=s.filter+" "+r}}n(s.filter,null,null,o,s)}})})},toGrid:function(){return this.each(function(){var t=this.config;if(t.layoutMode!="grid"){t.layoutMode="grid";n(t.filter,null,null,e(this),t)}})},toList:function(){return this.each(function(){var t=this.config;if(t.layoutMode!="list"){t.layoutMode="list";n(t.filter,null,null,e(this),t)}})},filter:function(t){return this.each(function(){var r=this.config;if(!r.mixing){e(r.filterSelector).removeClass("active");t.split(" ").forEach(function(t){e(r.filterSelector+'[data-filter="'+t+'"]').addClass("active")});n(t,null,null,e(this),r)}})},sort:function(t){return this.each(function(){var r=this.config,i=e(this);if(!r.mixing){e(r.sortSelector).removeClass("active");if(e.isArray(t)){var s=t[0],o=t[1];e(r.sortSelector+'[data-sort="'+t[0]+'"][data-order="'+t[1]+'"]').addClass("active")}else{e(r.sortSelector+'[data-sort="'+t+'"]').addClass("active");var s=t,o="desc"}i.find(r.targetSelector).each(function(){r.startOrder.push(e(this))});n(r.filter,s,o,i,r)}})},multimix:function(t){return this.each(function(){var r=this.config,i=e(this);multiOut={filter:r.filter,sort:null,order:"desc",layoutMode:r.layoutMode};e.extend(multiOut,t);if(!r.mixing){e(r.filterSelector).add(r.sortSelector).removeClass("active");e(r.filterSelector+'[data-filter="'+multiOut.filter+'"]').addClass("active");if(typeof multiOut.sort!=="undefined"){e(r.sortSelector+'[data-sort="'+multiOut.sort+'"][data-order="'+multiOut.order+'"]').addClass("active");i.find(r.targetSelector).each(function(){r.startOrder.push(e(this))})}r.layoutMode=multiOut.layoutMode;n(multiOut.filter,multiOut.sort,multiOut.order,i,r)}})},remix:function(t){return this.each(function(){var r=this.config,i=e(this);r.origOrder=[];i.find(r.targetSelector).each(function(){var t=e(this);t.addClass("mix_all");r.origOrder.push(t)});if(!r.mixing&&typeof t!=="undefined"){e(r.filterSelector).removeClass("active");e(r.filterSelector+'[data-filter="'+t+'"]').addClass("active");n(t,null,null,i,r)}})}};e.fn.mixitup=function(e,n){if(t[e]){return t[e].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof e==="object"||!e){return t.init.apply(this,arguments)}};e.fn.removeStyle=function(t){return this.each(function(){var n=e(this);t=t.replace(/\s+/g,"");var r=t.split(",");e.each(r,function(){var e=new RegExp(this.toString()+"[^;]+;?","g");n.attr("style",function(t,n){if(n)return n.replace(e,"")})})})};Array.prototype.compare=function(e){if(this.length!=e.length)return false;for(var t=0;t<e.length;t++){if(this[t].compare){if(!this[t].compare(e[t]))return false}if(this[t]!==e[t])return false}return true};})(jQuery);