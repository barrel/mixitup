/*
* MIXITUP - A CSS3 and JQuery Filter & Sort Plugin
* Version: 1.5.4
* License: Creative Commons Attribution-NoDerivs 3.0 Unported - CC BY-ND 3.0
* http://creativecommons.org/licenses/by-nd/3.0/
* This software may be used freely on commercial and non-commercial projects with attribution to the author/copyright holder.
* Author: Patrick Kunka
* Copyright 2012-2013 Patrick Kunka, Barrel LLC, All Rights Reserved
* 
* http://mixitup.io
*/

(function(d){function q(c,a,f,e,b){function h(){m.unbind("webkitTransitionEnd transitionend otransitionend oTransitionEnd");a&&x(a,f,e,b);b.startOrder=[];b.newOrder=[];b.origSort=[];b.checkSort=[];v.removeStyle(b.prefix+"filter, filter, "+b.prefix+"transform, transform, opacity, display").css(b.clean).removeAttr("data-checksum");window.atob||v.css({display:"none",opacity:"0"});m.removeStyle(b.prefix+"transition, transition, "+b.prefix+"perspective, perspective, "+b.prefix+"perspective-origin, perspective-origin, "+
(b.resizeContainer?"height":""));"list"==b.layoutMode?(n.css({display:b.targetDisplayList,opacity:"1"}),b.origDisplay=b.targetDisplayList):(n.css({display:b.targetDisplayGrid,opacity:"1"}),b.origDisplay=b.targetDisplayGrid);b.origLayout=b.layoutMode;setTimeout(function(){v.removeStyle(b.prefix+"transition, transition");b.mixing=!1;if("function"==typeof b.onMixEnd){var a=b.onMixEnd.call(this,b);b=a?a:b}})}clearInterval(b.failsafe);b.mixing=!0;b.filter=c;if("function"==typeof b.onMixStart){var g=b.onMixStart.call(this,
b);b=g?g:b}for(var k=b.transitionSpeed,g=0;2>g;g++){var s=0==g?s=b.prefix:"";b.transition[s+"transition"]="all "+k+"ms linear";b.transition[s+"transform"]=s+"translate3d(0,0,0)";b.perspective[s+"perspective"]=b.perspectiveDistance+"px";b.perspective[s+"perspective-origin"]=b.perspectiveOrigin}var w=b.targetSelector,v=e.find(w);v.each(function(){this.data={}});var m=v.parent();m.css(b.perspective);b.easingFallback="ease-in-out";"smooth"==b.easing&&(b.easing="cubic-bezier(0.25, 0.46, 0.45, 0.94)");
"snap"==b.easing&&(b.easing="cubic-bezier(0.77, 0, 0.175, 1)");"windback"==b.easing&&(b.easing="cubic-bezier(0.175, 0.885, 0.320, 1.275)",b.easingFallback="cubic-bezier(0.175, 0.885, 0.320, 1)");"windup"==b.easing&&(b.easing="cubic-bezier(0.6, -0.28, 0.735, 0.045)",b.easingFallback="cubic-bezier(0.6, 0.28, 0.735, 0.045)");g="list"==b.layoutMode&&null!=b.listEffects?b.listEffects:b.effects;Array.prototype.indexOf&&(b.fade=-1<g.indexOf("fade")?"0":"",b.scale=-1<g.indexOf("scale")?"scale(.01)":"",b.rotateZ=
-1<g.indexOf("rotateZ")?"rotate(180deg)":"",b.rotateY=-1<g.indexOf("rotateY")?"rotateY(90deg)":"",b.rotateX=-1<g.indexOf("rotateX")?"rotateX(90deg)":"",b.blur=-1<g.indexOf("blur")?"blur(8px)":"",b.grayscale=-1<g.indexOf("grayscale")?"grayscale(100%)":"");var n=d(),r=d(),t=[],q=!1;"string"===typeof c?t=z(c):(q=!0,d.each(c,function(b){t[b]=z(this)}));"or"==b.filterLogic?(""==t[0]&&t.shift(),1>t.length?r=r.add(e.find(w+":visible")):v.each(function(){var b=d(this);if(q){var a=0;d.each(t,function(d){this.length?
b.is("."+this.join(", ."))&&a++:0<a&&a++});a==t.length?n=n.add(b):r=r.add(b)}else b.is("."+t.join(", ."))?n=n.add(b):r=r.add(b)})):(n=n.add(m.find(w+"."+t.join("."))),r=r.add(m.find(w+":not(."+t.join(".")+"):visible")));c=n.length;var u=d(),p=d(),l=d();r.each(function(){var b=d(this);"none"!=b.css("display")&&(u=u.add(b),l=l.add(b))});if(n.filter(":visible").length==c&&!u.length&&!a){if(b.origLayout==b.layoutMode)return h(),!1;if(1==n.length)return"list"==b.layoutMode?(e.addClass(b.listClass),e.removeClass(b.gridClass),
l.css("display",b.targetDisplayList)):(e.addClass(b.gridClass),e.removeClass(b.listClass),l.css("display",b.targetDisplayGrid)),h(),!1}b.origHeight=m.height();if(n.length){e.removeClass(b.failClass);n.each(function(){var b=d(this);"none"==b.css("display")?p=p.add(b):l=l.add(b)});if(b.origLayout!=b.layoutMode&&!1==b.animateGridList)return"list"==b.layoutMode?(e.addClass(b.listClass),e.removeClass(b.gridClass),l.css("display",b.targetDisplayList)):(e.addClass(b.gridClass),e.removeClass(b.listClass),
l.css("display",b.targetDisplayGrid)),h(),!1;if(!window.atob)return h(),!1;v.css(b.clean);l.each(function(){this.data.origPos=d(this).offset()});"list"==b.layoutMode?(e.addClass(b.listClass),e.removeClass(b.gridClass),p.css("display",b.targetDisplayList)):(e.addClass(b.gridClass),e.removeClass(b.listClass),p.css("display",b.targetDisplayGrid));p.each(function(){this.data.showInterPos=d(this).offset()});u.each(function(){this.data.hideInterPos=d(this).offset()});l.each(function(){this.data.preInterPos=
d(this).offset()});"list"==b.layoutMode?l.css("display",b.targetDisplayList):l.css("display",b.targetDisplayGrid);a&&x(a,f,e,b);if(a&&A(b.origSort,b.checkSort))return h(),!1;u.hide();p.each(function(b){this.data.finalPos=d(this).offset()});l.each(function(){this.data.finalPrePos=d(this).offset()});b.newHeight=m.height();a&&x("reset",null,e,b);p.hide();l.css("display",b.origDisplay);"block"==b.origDisplay?(e.addClass(b.listClass),p.css("display",b.targetDisplayList)):(e.removeClass(b.listClass),p.css("display",
b.targetDisplayGrid));b.resizeContainer&&m.css("height",b.origHeight+"px");c={};for(g=0;2>g;g++)s=0==g?s=b.prefix:"",c[s+"transform"]=b.scale+" "+b.rotateX+" "+b.rotateY+" "+b.rotateZ,c[s+"filter"]=b.blur+" "+b.grayscale;p.css(c);l.each(function(){var a=this.data,c=d(this);c.hasClass("mix_tohide")?(a.preTX=a.origPos.left-a.hideInterPos.left,a.preTY=a.origPos.top-a.hideInterPos.top):(a.preTX=a.origPos.left-a.preInterPos.left,a.preTY=a.origPos.top-a.preInterPos.top);for(var e={},f=0;2>f;f++){var g=
0==f?g=b.prefix:"";e[g+"transform"]="translate("+a.preTX+"px,"+a.preTY+"px)"}c.css(e)});"list"==b.layoutMode?(e.addClass(b.listClass),e.removeClass(b.gridClass)):(e.addClass(b.gridClass),e.removeClass(b.listClass));setTimeout(function(){if(b.resizeContainer){for(var a={},c=0;2>c;c++){var e=0==c?e=b.prefix:"";a[e+"transition"]="all "+k+"ms ease-in-out";a.height=b.newHeight+"px"}m.css(a)}u.css("opacity",b.fade);p.css("opacity",1);p.each(function(){var a=this.data;a.tX=a.finalPos.left-a.showInterPos.left;
a.tY=a.finalPos.top-a.showInterPos.top;for(var c={},e=0;2>e;e++){var f=0==e?f=b.prefix:"";c[f+"transition-property"]=f+"transform, "+f+"filter, opacity";c[f+"transition-timing-function"]=b.easing+", linear, linear";c[f+"transition-duration"]=k+"ms";c[f+"transition-delay"]="0";c[f+"transform"]="translate("+a.tX+"px,"+a.tY+"px)";c[f+"filter"]="none"}d(this).css("-webkit-transition","all "+k+"ms "+b.easingFallback).css(c)});l.each(function(){var a=this.data;a.tX=0!=a.finalPrePos.left?a.finalPrePos.left-
a.preInterPos.left:0;a.tY=0!=a.finalPrePos.left?a.finalPrePos.top-a.preInterPos.top:0;for(var c={},e=0;2>e;e++){var f=0==e?f=b.prefix:"";c[f+"transition"]="all "+k+"ms "+b.easing;c[f+"transform"]="translate("+a.tX+"px,"+a.tY+"px)"}d(this).css("-webkit-transition","all "+k+"ms "+b.easingFallback).css(c)});a={};for(c=0;2>c;c++)e=0==c?e=b.prefix:"",a[e+"transition"]="all "+k+"ms "+b.easing+", "+e+"filter "+k+"ms linear, opacity "+k+"ms linear",a[e+"transform"]=b.scale+" "+b.rotateX+" "+b.rotateY+" "+
b.rotateZ,a[e+"filter"]=b.blur+" "+b.grayscale,a.opacity=b.fade;u.css(a);m.bind("webkitTransitionEnd transitionend otransitionend oTransitionEnd",function(a){if(-1<a.originalEvent.propertyName.indexOf("transform")||-1<a.originalEvent.propertyName.indexOf("opacity"))-1<w.indexOf(".")?d(a.target).hasClass(w.replace(".",""))&&h():d(a.target).is(w)&&h()})},10);b.failsafe=setTimeout(function(){b.mixing&&h()},k+400)}else{b.resizeContainer&&m.css("height",b.origHeight+"px");if(!window.atob)return h(),!1;
u=r;setTimeout(function(){m.css(b.perspective);if(b.resizeContainer){for(var a={},c=0;2>c;c++){var d=0==c?d=b.prefix:"";a[d+"transition"]="height "+k+"ms ease-in-out";a.height=b.minHeight+"px"}m.css(a)}v.css(b.transition);if(r.length){a={};for(c=0;2>c;c++)d=0==c?d=b.prefix:"",a[d+"transform"]=b.scale+" "+b.rotateX+" "+b.rotateY+" "+b.rotateZ,a[d+"filter"]=b.blur+" "+b.grayscale,a.opacity=b.fade;u.css(a);m.bind("webkitTransitionEnd transitionend otransitionend oTransitionEnd",function(a){if(-1<a.originalEvent.propertyName.indexOf("transform")||
-1<a.originalEvent.propertyName.indexOf("opacity"))e.addClass(b.failClass),h()})}else b.mixing=!1},10)}}function x(c,a,f,e){function b(a,b){var e=isNaN(1*a.attr(c))?a.attr(c).toLowerCase():1*a.attr(c),d=isNaN(1*b.attr(c))?b.attr(c).toLowerCase():1*b.attr(c);return e<d?-1:e>d?1:0}function h(b){"asc"==a?k.prepend(b).prepend(" "):k.append(b).append(" ")}function g(a){a=a.slice();for(var b=a.length,c=b;c--;){var e=parseInt(Math.random()*b),d=a[c];a[c]=a[e];a[e]=d}return a}f.find(e.targetSelector).wrapAll('<div class="mix_sorter"/>');
var k=f.find(".mix_sorter");e.origSort.length||k.find(e.targetSelector+":visible").each(function(){d(this).wrap("<s/>");e.origSort.push(d(this).parent().html().replace(/\s+/g,""));d(this).unwrap()});k.empty();if("reset"==c)d.each(e.startOrder,function(){k.append(this).append(" ")});else if("default"==c)d.each(e.origOrder,function(){h(this)});else if("random"==c)e.newOrder.length||(e.newOrder=g(e.startOrder)),d.each(e.newOrder,function(){k.append(this).append(" ")});else if("custom"==c)d.each(a,function(){h(this)});
else{if("undefined"===typeof e.origOrder[0].attr(c))return console.log("No such attribute found. Terminating"),!1;e.newOrder.length||(d.each(e.origOrder,function(){e.newOrder.push(d(this))}),e.newOrder.sort(b));d.each(e.newOrder,function(){h(this)})}e.checkSort=[];k.find(e.targetSelector+":visible").each(function(a){var b=d(this);0==a&&b.attr("data-checksum","1");b.wrap("<s/>");e.checkSort.push(b.parent().html().replace(/\s+/g,""));b.unwrap()});f.find(e.targetSelector).unwrap()}function B(c){for(var a=
["Webkit","Moz","O","ms"],d=0;d<a.length;d++)if(a[d]+"Transition"in c.style)return a[d];return"transition"in c.style?"":!1}function A(c,a){if(c.length!=a.length)return!1;for(var d=0;d<a.length;d++)if(c[d].compare&&!c[d].compare(a[d])||c[d]!==a[d])return!1;return!0}function z(c){c=c.replace(/\s{2,}/g," ");var a=c.split(" ");d.each(a,function(c){"all"==this&&(a[c]="mix_all")});""==a[0]&&a.shift();return a}var y={init:function(c){return this.each(function(){var a={targetSelector:".mix",filterSelector:".filter",
sortSelector:".sort",buttonEvent:"click",effects:["fade","scale"],listEffects:null,easing:"smooth",layoutMode:"grid",targetDisplayGrid:"inline-block",targetDisplayList:"block",listClass:"",gridClass:"",transitionSpeed:600,showOnLoad:"all",sortOnLoad:!1,multiFilter:!1,filterLogic:"or",resizeContainer:!0,minHeight:0,failClass:"fail",perspectiveDistance:"3000",perspectiveOrigin:"50% 50%",animateGridList:!0,onMixLoad:null,onMixStart:null,onMixEnd:null,container:null,origOrder:[],startOrder:[],newOrder:[],
origSort:[],checkSort:[],filter:"",mixing:!1,origDisplay:"",origLayout:"",origHeight:0,newHeight:0,isTouch:!1,resetDelay:0,failsafe:null,prefix:"",easingFallback:"ease-in-out",transition:{},perspective:{},clean:{},fade:"1",scale:"",rotateX:"",rotateY:"",rotateZ:"",blur:"",grayscale:""};c&&d.extend(a,c);this.config=a;d.support.touch="ontouchend"in document;d.support.touch&&(a.isTouch=!0,a.resetDelay=350);a.container=d(this);var f=a.container;a.prefix=B(f[0]);a.prefix=a.prefix?"-"+a.prefix.toLowerCase()+
"-":"";f.find(a.targetSelector).each(function(){a.origOrder.push(d(this))});if(a.sortOnLoad){var e,b;d.isArray(a.sortOnLoad)?(e=a.sortOnLoad[0],b=a.sortOnLoad[1],d(a.sortSelector+"[data-sort="+a.sortOnLoad[0]+"][data-order="+a.sortOnLoad[1]+"]").addClass("active")):(d(a.sortSelector+"[data-sort="+a.sortOnLoad+"]").addClass("active"),e=a.sortOnLoad,a.sortOnLoad="desc");x(e,b,f,a)}for(e=0;2>e;e++)b=0==e?b=a.prefix:"",a.transition[b+"transition"]="all "+a.transitionSpeed+"ms ease-in-out",a.perspective[b+
"perspective"]=a.perspectiveDistance+"px",a.perspective[b+"perspective-origin"]=a.perspectiveOrigin;for(e=0;2>e;e++)b=0==e?b=a.prefix:"",a.clean[b+"transition"]="none";"list"==a.layoutMode?(f.addClass(a.listClass),a.origDisplay=a.targetDisplayList):(f.addClass(a.gridClass),a.origDisplay=a.targetDisplayGrid);a.origLayout=a.layoutMode;e=a.showOnLoad.split(" ");d.each(e,function(){d(a.filterSelector+'[data-filter="'+this+'"]').addClass("active")});f.find(a.targetSelector).addClass("mix_all");"all"==
e[0]&&(e[0]="mix_all",a.showOnLoad="mix_all");var h=d();"or"==a.filterLogic?d.each(e,function(){h=h.add(d("."+this))}):h=d("."+e.join("."));h.each(function(){var b=d(this);"list"==a.layoutMode?b.css("display",a.targetDisplayList):b.css("display",a.targetDisplayGrid);b.css(a.transition)});setTimeout(function(){a.mixing=!0;h.css("opacity","1");setTimeout(function(){"list"==a.layoutMode?h.removeStyle(a.prefix+"transition, transition").css({display:a.targetDisplayList,opacity:1}):h.removeStyle(a.prefix+
"transition, transition").css({display:a.targetDisplayGrid,opacity:1});a.mixing=!1;if("function"==typeof a.onMixLoad){var b=a.onMixLoad.call(this,a);a=b?b:a}},a.transitionSpeed)},10);a.filter=a.showOnLoad;d(a.sortSelector).bind(a.buttonEvent,function(){if(!a.mixing){var b=d(this),c=b.attr("data-sort"),e=b.attr("data-order");if(!b.hasClass("active"))d(a.sortSelector).removeClass("active"),b.addClass("active");else if("random"!=c)return!1;f.find(a.targetSelector).each(function(){a.startOrder.push(d(this))});
q(a.filter,c,e,f,a)}});d(a.filterSelector).bind(a.buttonEvent,function(){if(!a.mixing){var b=d(this);if(!1==a.multiFilter)d(a.filterSelector).removeClass("active"),b.addClass("active"),a.filter=b.attr("data-filter"),d(a.filterSelector+'[data-filter="'+a.filter+'"]').addClass("active");else{var c=b.attr("data-filter");b.hasClass("active")?(b.removeClass("active"),a.filter=a.filter.replace(RegExp("(\\s|^)"+c),"")):(b.addClass("active"),a.filter=a.filter+" "+c)}q(a.filter,null,null,f,a)}})})},toGrid:function(){return this.each(function(){var c=
this.config;"grid"!=c.layoutMode&&(c.layoutMode="grid",q(c.filter,null,null,d(this),c))})},toList:function(){return this.each(function(){var c=this.config;"list"!=c.layoutMode&&(c.layoutMode="list",q(c.filter,null,null,d(this),c))})},filter:function(c){return this.each(function(){var a=this.config;a.mixing||(d(a.filterSelector).removeClass("active"),d(a.filterSelector+'[data-filter="'+c+'"]').addClass("active"),q(c,null,null,d(this),a))})},sort:function(c){return this.each(function(){var a=this.config,
f=d(this);if(!a.mixing){d(a.sortSelector).removeClass("active");if(d.isArray(c)){var e=c[0],b=c[1];d(a.sortSelector+'[data-sort="'+c[0]+'"][data-order="'+c[1]+'"]').addClass("active")}else d(a.sortSelector+'[data-sort="'+c+'"]').addClass("active"),e=c,b="desc";f.find(a.targetSelector).each(function(){a.startOrder.push(d(this))});q(a.filter,e,b,f,a)}})},multimix:function(c){return this.each(function(){var a=this.config,f=d(this);multiOut={filter:a.filter,sort:null,order:"desc",layoutMode:a.layoutMode};
d.extend(multiOut,c);a.mixing||(d(a.filterSelector).add(a.sortSelector).removeClass("active"),d(a.filterSelector+'[data-filter="'+multiOut.filter+'"]').addClass("active"),"undefined"!==typeof multiOut.sort&&(d(a.sortSelector+'[data-sort="'+multiOut.sort+'"][data-order="'+multiOut.order+'"]').addClass("active"),f.find(a.targetSelector).each(function(){a.startOrder.push(d(this))})),a.layoutMode=multiOut.layoutMode,q(multiOut.filter,multiOut.sort,multiOut.order,f,a))})},remix:function(c){return this.each(function(){var a=
this.config,f=d(this);a.origOrder=[];f.find(a.targetSelector).each(function(){var c=d(this);c.addClass("mix_all");a.origOrder.push(c)});a.mixing||"undefined"===typeof c||(d(a.filterSelector).removeClass("active"),d(a.filterSelector+'[data-filter="'+c+'"]').addClass("active"),q(c,null,null,f,a))})}};d.fn.mixitup=function(c,a){if(y[c])return y[c].apply(this,Array.prototype.slice.call(arguments,1));if("object"===typeof c||!c)return y.init.apply(this,arguments)};d.fn.removeStyle=function(c){return this.each(function(){var a=
d(this);c=c.replace(/\s+/g,"");var f=c.split(",");d.each(f,function(){var c=RegExp(this.toString()+"[^;]+;?","g");a.attr("style",function(a,d){if(d)return d.replace(c,"")})})})}})(jQuery);
